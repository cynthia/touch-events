<!DOCTYPE html>
<html>
  <head>
    <title>Touch Events Specification</title>
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
    <!--
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/respec.js' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus:           "ED",

          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "touch-events",

          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          // subtitle   :  "an excellent document",

          // if you wish the publication date to be other than today, set this
          publishDate:  "2011-03-25",

          // if the specification's copyright date is a range of years, specify
          // the start date here:
          // copyrightStart: "2005"

          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          // previousPublishDate:  "1977-03-15",
          // previousMaturity:  "WD",

          // if there a publicly available Editor's Draft, this is the link
          edDraftURI:           "http://dvcs.w3.org/hg/webevents/raw-file/tip/touchevents.html",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",

          // if you want to have extra CSS, append them to this list
          // it is recommended that the respec.css stylesheet be kept
          extraCSS:             ["http://www.w3.org/StyleSheets/TR/W3C-TR.css", "http://dev.w3.org/2009/dap/ReSpec.js/css/respec.css"],

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Doug Schepers", url: "http://schepers.cc/",
                company: "W3C", companyURL: "http://w3.org/" },
              { name: "Sangwhan Moon",
                company: "Opera Software ASA", companyURL: "http://www.opera.com/" },
              { name: "Matt Brubeck",
                company: "Mozilla", companyURL: "http://www.mozilla.org/" },
          ],

          // authors, add as many as you like.
          // This is optional, uncomment if you have authors as well as editors.
          // only "name" is required. Same format as editors.

          //authors:  [
          //    { name: "Your Name", url: "http://example.org/",
          //      company: "Your Company", companyURL: "http://example.com/" },
          //],

          // name of the WG
          wg:           "Web Events Working Group",

          // URI of the public WG page
          wgURI:        "http://www.w3.org/2010/webevents/",

          // name (with the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "public-webevents",

          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/45559/status",
      };
    </script>

    <style>
      .event {
        font-family: monospace;
        color: #459900;
      }
    </style>
  </head>
  <body>
    <section id='abstract'>
      The Touch Interface specification defines a set of low-level events that represent one or more points of contact with a touch-sensitive surface, and changes of those points with respect to the surface and any DOM elements displayed upon it (e.g. for touch screens) or associated with it (e.g. for drawing tablets without displays).  It also addresses pen-tablet devices, such as drawing tablets, with consideration toward stylus capabilities.
    </section>


    <section>
      <h2><a>TouchPoint</a> Interface</h2>
      <p>This interface defines an individual point of contact for a touch event.</p>

      <dl title='interface TouchPoint' class='idl'>
        <dt>readonly attribute long identifier</dt>
        <dd>
          An identification number for each <a>touch point</a>, unique to that <a>touch point</a> per session.

          <p>The algorithm for determining the <a>identifier</a> value is as follows:</p>
          <ol>
            <li>if there are no other <a>active touch event session</a>s, the value of <a>identifier</a> must be <code>0</code></li>
            <li>if there is at least one <a>active touch event session</a>, the value of <a>identifier</a> must be the lowest integer not currently used by any active <a>TouchPoint</a> object in any <a>active touch event session</a></li>
          </ol>
        </dd>
        <dt>readonly attribute EventTarget target</dt>
        <dd>
          the original proximal event target for this <a>touch point</a>.  The target must be an <a>Element</a>.
        </dd>
        <dt>readonly attribute DOMTimeStamp timestamp</dt>
        <dd>
          The <a>timestamp</a> attribute represents the time when the <a>TouchPoint</a> was initiated and is represented as a DOMTimeStamp [[!DOM-LEVEL-3-CORE]].
          <p class="issue" id="issue-timestamp-format"><strong>Issue:</strong> should we align to timestamp as defined in the <a href="http://dev.w3.org/geo/api/#timestamp">Geolocation API spec</a> (as above), or with the datetime as defined in the <a href="http://dev.w3.org/html5/spec/edits.html#attr-mod-datetime">HTML5 spec</a> (attribute DOMString dateTime, where datetime is a <a href="http://dev.w3.org/html5/spec/common-microsyntaxes.html#valid-global-date-and-time-string">valid global date and time string</a>), or to something else (see <a href="http://lists.w3.org/Archives/Public/www-dom/2010OctDec/0069.html">this thread on Event.timeStamp</a>)?</p>

          <p class="issue" id="issue-timestamp"><strong>Issue:</strong> Should each touchpoint have its own timestamp?  Or should we leave timestamps up to script authors?  My feeling is that having implicit timestamps may be useful in defining an author-defined gesture-like mapping between low-level and high-level events (e.g. a swipe vs. drag speed threshold expressed as the difference in timestamps)</p>
        </dd>

        <dt>readonly attribute long screenX</dt>
        <dd>
          x-coordinate of point relative to the screen
        </dd>
        <dt>readonly attribute long screenY</dt>
        <dd>
          y-coordinate of point relative to the screen
        </dd>

        <dt>readonly attribute long clientX</dt>
        <dd>
          x-coordinate of point relative to the viewport, excluding any scroll offset
        </dd>
        <dt>readonly attribute long clientY</dt>
        <dd>
          y-coordinate of point relative to the viewport, excluding any scroll offset
        </dd>

        <dt>readonly attribute long pageX</dt>
        <dd>
          x-coordinate of point relative to the viewport, including any scroll offset
        </dd>
        <dt>readonly attribute long pageY</dt>
        <dd>
          y-coordinate of point relative to the viewport, including any scroll offset
        </dd>

        <dt>readonly attribute long radiusX</dt>
        <dd>
          the radius of the ellipse which most closely circumscribes the touching area (e.g. finger, stylus) along the x-axis, in pixels of the same scale as <a>screenX</a>; <code>1</code> if no value is known.  This attribute may not be available on all user agents or platforms.
          <p class="issue" id="issue-units"><strong>Issue:</strong> What are units of radiusX/radiusY?  CSS Pixels?</p>
        </dd>
        <dt>readonly attribute long radiusY</dt>
        <dd>
          the radius of the ellipse which most closely circumscribes the touching area (e.g. finger, stylus) along the y-axis, in pixels of the same scale as <a>screenY</a>; <code>1</code> if no value is known.  This attribute may not be available on all user agents or platforms.
        </dd>

        <dt>readonly attribute float rotationAngle</dt>
        <dd>
          the angle (in degrees) that the ellipse described by <a>radiusX</a> and <a>radiusY</a> is rotated counter-clockwise about its center.  The value must be in the range (-90, 90].
        </dd>

        <dt>readonly attribute float force</dt>
        <dd>
          a relative value of pressure applied, in the range <code>0</code> to <code>1</code>, where <code>0</code> is no pressure, and <code>1</code> is the highest level of pressure the touch device is capable of sensing; <code>0</code> if no value is known.  This attribute may not be available on all user agents or platforms.  In environments where <a>force</a> is available, the absolute pressure represented by the <a>force</a> attribute, and the sensitivity in levels of pressure, may vary.

          <p class="issue" id="issue-inkml"><strong>Issue:</strong> Consider aligning with other "channels" and values from <a href="http://www.w3.org/TR/InkML/#channelContents">Ink Markup Language (InkML)</a>, in addition to <a>force</a>, e.g. adding <a>angle</a>, <a>clientZ</a>, <a>rotation</a>, etc.</p>
        </dd>

        <dt>readonly attribute boolean altKey</dt>
        <dd>
          <code>true</code> if the alt (Alternate) key modifier is activated; otherwise <code>false</code>
        </dd>
        <dt>readonly attribute boolean metaKey</dt>
        <dd>
          <code>true</code> if the meta (Meta) key modifier is activated; otherwise <code>false</code>

          <p class="issue" id="issue-units"><strong>Issue:</strong> Should a exception be mentioned for platforms/user agents that are missing meta key support?</p>
        </dd>
        <dt>readonly attribute boolean ctrlKey</dt>
        <dd>
          <code>true</code> if the ctrl (Control) key modifier is activated; otherwise <code>false</code>
        </dd>
        <dt>readonly attribute boolean shiftKey</dt>
        <dd>
          <code>true</code> if the shift (Shift) key modifier is activated; otherwise <code>false</code>
        </dd>
      </dl>

    </section>


    <section>
      <h2><a>TouchList</a> Interface</h2>
      <p>This interface defines a list of individual points of contact for a touch event.</p>

      <dl title='interface TouchList' class='idl'>
        <dt>readonly attribute unsigned long length</dt>
        <dd>
          returns the number of touchpoints in the list
        </dd>
        <dt>caller getter <a>TouchPoint</a> item (in unsigned long <a>index</a>)</dt>
        <dd>
          returns the touchpoint with index <a>index</a> from the list, sorted in order from latest to earliest
        </dd>
        <dt>caller getter object identifiedPoint (in long <a>identifier</a>)</dt>
        <dd>
          returns the first touchpoint with long <a>identifier</a> from the list
        </dd>
      </dl>
    </section>


    <section>
      <h2><a>TouchEvent</a> Interface</h2>
      <p>This interface defines the <a>touchstart</a>, <a>touchend</a>, <a>touchmove</a>, <a>touchenter</a>, <a>touchleave</a>, and <a>touchcancel</a> event types.</p>

      <dl title='interface TouchEvent : UIEvent' class='idl'>
        <dt>readonly attribute <a>TouchList</a> touches</dt>
        <dd>
          a list of <a>TouchPoint</a>s for every point of contact currently touching the surface
        </dd>
        <dt>readonly attribute <a>TouchList</a> targetTouches</dt>
        <dd>
          a list of <a>TouchPoint</a>s for every point of contact currently touching the surface, which started on the same target
        </dd>
        <dt>readonly attribute <a>TouchList</a> changedTouches</dt>
        <dd>
          a list of <a>TouchPoint</a>s for every point of contact which contributed to the event
        </dd>
      </dl>

      <p class="issue" id="issue-preventDefault"><strong>Issue:</strong> define behavior of preventDefault() method.</p>


      <section>
        <h3 id="event-touchstart">The <dfn class="event">touchstart</dfn> event</h3>
        <p>A user agent must dispatch this event type to indicate when the user places a <a>touch point</a> on the touch surface.</p>
      </section>

      <section>
        <h3 id="event-touchend">The <dfn class="event">touchend</dfn> event</h3>
        <p>A user agent must dispatch this event type to indicate when the user removes a <a>touch point</a> from the touch surface.</p>
      </section>

      <section>
        <h3 id="event-touchmove">The <dfn class="event">touchmove</dfn> event</h3>
        <p>A user agent must dispatch this event type to indicate when the user moves a <a>touch point</a> along the touch surface, even outside the interactive area of the <a>target</a> element.</p>
      </section>

      <section>
        <h3 id="event-touchenter">The <dfn class="event">touchenter</dfn> event</h3>
        <p>A user agent must dispatch this event type to indicate when a <a>touch point</a> moves onto the interactive area defined by a DOM element on which it did not originate.  Events of this type must not bubble.</p>

        <p class="issue" id="issue-touchenter-reenter"><strong>Issue:</strong> it's not clear if a touchenter event can occur when a touch re-enters the target of the touch start. It seems to say 'no' (Matthew Schinckel)</p>
      </section>

      <section>
        <h3 id="event-touchleave">The <dfn class="event">touchleave</dfn> event</h3>
        <p>A user agent must dispatch this event type to indicate when a <a>touch point</a> moves off the interactive area defined by a DOM element.  Events of this type must not bubble.</p>
      </section>

      <section>
        <h3 id="event-touchstart">The <dfn class="event">touchcancel</dfn> event</h3>
        <p>A user agent must dispatch this event type to indicate when a <a>TouchPoint</a> has been disrupted in an implementation-specific manner, such as by moving outside the bounds of the UA window.  A user agent may also dispatch this event type when the user places more <a>touch point</a>s on the touch surface than the device or implementation is configured to store, in which case the earliest <a>TouchPoint</a> object in the <a>TouchList</a> should be removed.</p>
      </section>
    </section>

    <section>
      <h2>Glossary</h2>

      <dl>
        <dt><dfn>active touch event session</dfn></dt>
        <dd>A conceptual state in which there is at least one instance of a <a>TouchEvent</a> event with at least one non-empty <a>TouchList</a>.
          <!-- <pre class='example'>
          </pre> -->
        </dd>

        <dt><dfn>touch point</dfn></dt>
        <dd>The coordinate point at which a pointer (e.g finger or stylus) intersects the target surface of an interface.  This may apply to a finger touching a touch-screen, or an digital pen writing on a piece of paper.</dd>

      </dl>

    </section>

    <section class='appendix'>
      <h2>Acknowledgements</h2>
      <p>
        Many thanks to the WebKit engineers for developing the model used as a basis for this spec, Neil Roberts (SitePen) for his summary of WebKit touch events, Peter-Paul Koch (PPK) for his writeups and suggestions, Robin Berjon for developing the <a href="http://dev.w3.org/2009/dap/ReSpec.js/documentation.html">ReSpec.js spec authoring tool</a>, and the WebEvents WG for their many contributions</a>.
      </p>

      <p>Many others have made additional comments as the spec developed, which have led to steady improvements.  Among them are Matthew Schinckel, . If I inadvertently omitted your name, please let me know.</p>
    </section>
  </body>
</html>
